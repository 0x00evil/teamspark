<head>
  <title>Team Spark</title>
</head>

<body>
<div class="container-fluid">
  {{>content}}
</div>
</body>

<template name="content">
  {{#if loggedIn }}
    <div class="row-fluid stretch">
      <div class="span2 project-panel stretch sidebar-nav attraction">
        {{>projects}}
      </div>
      <div class="span6 spark-panel stretch">
        <header><h4>途客圈战队</h4></header>
        {{> sparkBoard}}
      </div>
      <div class="span4 activity-panel stretch attraction">
        {{#if teamActivity}}
          {{#each members}}
            {{>member}}
          {{/each}}
        {{else}}
          {{#each projects}}
            {{>project}}
          {{/each}}
        {{/if}}
      </div>
    </div>
  {{else}}
    {{loginButtons}}
  {{/if}}
</template>
<template name="projects">
  <ul class="nav nav-list">
    {{>shortcuts}}
    <li class="nav-header">项目</li>
    {{#each projects}}
      <li><a href="#">{{ name }} ({{totalItems}})</a></li>
    {{/each}}
  </ul>

  {{>profile}}

  <div class="btn-toolbar navbar-fixed-bottom" style="margin: 5px;">
    <div class="btn-group" id="filter-type" data-toggle="buttons-radio">
      <button class="btn" title="团队"><i class="icon-group"></i></button>
      <button class="btn" title="个人"><i class="icon-user"></i></button>
    </div>

    <div class="btn-group" id="user-settings">
      {{# if ts.isStaff }}
      <a class="btn" title="添加成员">
        <i class="icon-plus"></i>
      </a>
      {{/if}}
      <a class="btn" id="add-project" title="添加项目">
        <i class="icon-plus-sign"></i>
      </a>
      <a class="btn" title="个人资料"><i class="icon-cogs"></i></a>
      <a class="btn" title="退出登录"><i class="icon-signout"></i></a>

    </div>
  </div>

  <div class="modal fade hide" id="add-project-dialog">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3>添加新项目</h3>
    </div>
    <div class="modal-body">
      <form class="form-horizontal">
        <div class="control-group">
          <label class="control-label" for="project-name">请输入项目名称</label>
          <input type="text" name="name" id="project-name" placeholder="比如：cayman" />
        </div>

        <div class="control-group">
          <label class="control-label" for="project-description">请输入项目描述</label>
          <textarea name="description" id="project-description" placeholder="让别人了解你的项目"></textarea>
        </div>

        {{#if hasProject}}
        <div class="control-group">
          <label class="control-label" for="project-parent">请选择父级项目</label>
          <select name="parent" id="project-parent">
            {{#each projects}}
            <option value="{{_id}}">{{name}}</option>
            {{/each}}
          </select>
        </div>
        {{/if}}
      </form>
    </div>
    <div class="modal-footer">
      <a href="#" class="btn" id="add-project-cancel">取消</a>
      <a href="#" class="btn btn-primary" id="add-project-submit">立即创建</a>
    </div>
  </div>
</template>

<template name="shortcuts">
  <li class="nav-header">任务</li>
  <li><a href="#"><i class="icon-time"></i>重要 ({{totalImportant}})</a></li>
  <li><a href="#"><i class="icon-asterisk"></i>紧急 ({{totalUrgent}})</a></li>
</template>

<template name="profile">
  <div class="profile">
    <div>
      <img src="{{ avatar }}" alt="{{ name }}" />
      <h5>{{name}}</h5>
      <p>{{description}}</p>
    </div>
    <ul>
      <li>已完成：{{totalFinished}}</li>
      <li>已提交：{{totalSubmitted}}</li>
    </ul>
  </div>
</template>


<template name="sparkBoard">
  {{>sparkFilter}}
  {{>sparkInput}}
  {{#each sparks}}
    {{>spark}}
  {{/each}}
</template>

<template name="sparkFilter">
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <ul class="nav pull-right">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-user"></i> 筛选作者<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="#">全部</a></li>
              {{#each member in members}}
              <li><a href="#">{{member.username}}</a></li>
              {{/each}}
            </ul>
          </li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-list-ul"></i> 筛选项目<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="#">全部</a></li>
              {{#each project in projects}}
              <li><a href>{{project.name}}</a></li>
              {{/each}}
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
</template>

<template name="sparkInput">
  <div class="spark-input">
    <div class="avatar">
      <img class="avatar" src="http://tp1.sinaimg.cn/1737931304/50/5624873554/1" alt="{{username}}" />
    </div>
    <div class="input-container">
      <ul class="nav category">
        <li class="active"><a href="#"><i class="icon-magic"></i>点子</a></li>
        <li><a href="#"><i class="icon-exclamation-sign"></i>BUG</a></li>
        <li><a href="#"><i class="icon-money"></i>功能</a></li>
        <li><a href="#"><i class="icon-inbox"></i>任务</a></li>
      </ul>
      <form>
        <textarea name="content"></textarea>
        <input type="hidden" name="type" />
        <div class="controls">
          <div class="pull-left">
            <a href="#"><i class="icon-group"></i>分享给</a>
          </div>
          <div class="pull-right">
            <button class="btn btn-primary">发表</button>
          </div>
        </div>

      </form>
    </div>

  </div>
</template>

<template name="spark">

</template>

<template name="member">
  <
  <h1>{{username}}</h1>
</template>

<template name="project">
  <h1>{{name}}</h1>
</template>